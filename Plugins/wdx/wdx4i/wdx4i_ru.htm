<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN" "HTTP://WWW.W3.ORG/TR/HTML4/LOOSE.DTD">
<html>
<head>
<meta http-equiv="Content-Type" content="text/html; charset=Windows-1251">
<title>wdx4i для Total Commander</title>

<style>
body { font-family: "Times New Roman", Times, serif; }
h1, h2, h3, h4, h5, h6 { font-family: Verdana, Arial, Helvetica, sans-serif; }
h1 { font-weight: bold; font-size: 150%; }
h2 { font-weight: normal; font-size: 120%; list-style-type: decimal; }
h3 { font-weight: normal; font-size: 100%; }
h4 { font-weight: bold; font-size: smaller; }
strong { font-family: Verdana, Arial, Helvetica, sans-serif; font-weight: bolder; font-size: smaller; }
code, samp { font-family: Verdana, Arial, Helvetica, sans-serif; font-size: smaller; }
a { font-family: Verdana, Arial, Helvetica, sans-serif; font-weight: bolder; font-size: smaller; }
a:link    { color: Navy; }
a:visited { color: Purple; }
a:hover { color: Purple; }
</style>

</head>

<body>
<h1>Информационный плагин WDX for Images для Total Commander</h1>

<p align="right" style="font-size: smaller;"><a href="wdx4i.htm">Switch to English</a>

<p>Извлекает информацию из файлов форматов BMP, GIF, JPEG, JPEG 2000, PCX, PNG, PSD, TIFF:

<ul>
  <li>Реальный формат файла
  <li>Порядок байтов в целых числах
  <li>Количество страниц (TIFF), кадров (GIF), слоёв (PSD и TIFF), картинок и эскизов (JPEG)
  <li>Ширина и высота изображения в пикселах, по которым вычисляется отношение ширины к высоте, диагональ и количество пикселов в изображении
  <li>Количество сэмплов на пиксел (каналов в Photoshop)
  <li>Количество бит на сэмпл (глубина цвета одного сэмпла/канала)
  <li>Режим изображения: RGB, CMYK и т.д.
  <li>Метод сжатия данных изображения: LZW, RLE и т.д.
  <li>Разрешение картинки по осям X и Y, по которым вычисляются печатные размеры: ширина, высота, отношение длин сторон, диагональ и площадь.
</ul>

<p>В диалоге изменения атрибутов файла (TC версии 7 и выше) плагин позволяет изменить разрешение картинки (не все файлы).

<hr>

<p>Версия 0.5 для <a href="http://www.ghisler.com/">Total Commander</a> (x86 и x64).
Используйте на свой страх и риск.
Тестировался с <strong>Total Commander 7.04a, 8.01</strong>
под <strong>WinXP (rus)</strong> (необходимо <strong>WinNT 3.5</strong> или <strong>Win95</strong> или новее).

<p><b>ВНИМАНИЕ: В период тестирования плагина делайте резервные копии изображений перед установкой разрешения.</b>

<p>Плагин бесплатен для любого использования, хотя финансовая
поддержка приветствуется. Хотелось бы, чтобы он был полезным, однако НИКАКИХ
ГАРАНТИЙ, ПОДДЕРЖКИ и всё такое... Высказать соображения по поводу плагина,
задать вопрос, сообщить об ошибке, а при желании выслать деньги можно
<a href="#author">автору</a>.


<h2>Установка</h2>

<p>

<ul>
  <li><b>Стандартно</b>: войти архив с плагином и <code>pluginst.inf</code> при помощи TC для автоматической установки
  <li><b>Вручную</b>: меню <i>Конфигурация/Настройка...</i>, далее <i>Плагины&nbsp;/ Информационные плагины (.WDX)&nbsp;/ Настройка...</i>
</ul>

<p><b>Примечание.</b> В версии 0.2 была изменена строка определения типа файла.
Чтобы изменения произошли в настройках TC, нужно переустановить плагин либо
найти её в <code>wincmd.ini</code> и удалить.


<a name="#fields"></a>
<h2>Поля</h2>

<p><b>Примечание.</b> Все данные об изображении (ширина, высота...) &mdash; только для первого изображения в файле (страницы в TIFF и т.д.).

<ul>
  <li><b>iform</b> (<b>формат</b>) &mdash; название реального формата файла изображения вне зависимости от расширения
  <li><b>badext</b> (<b>пл-расш</b>) &mdash; &laquo;Да&raquo;, если расширение не соответствует формату
  <li><b>order</b> (<b>порядок</b>) &mdash; порядок байтов в целых числах из более, чем одного байта: от старшего к младшему, big-endian (Mac) или от младшего к старшему, little-endian (PC)
<!--  <LI><B>pages</B> (<B>страниц</B>) &mdash; количество страниц (TIFF), кадров (GIF), слоёв (PSD), картинок и эскизов (JPEG). Для остальных &mdash; 1-->
  <li><b>images</b> (<b>изображений</b>) &mdash; количество изображений (TIFF), кадров (GIF), изображений и эскизов (JPEG). Для остальных &mdash; 1
  <li><b>layers</b> (<b>слоёв</b>) &mdash; количество слоёв в PSD и первом изображениии в TIFF. Для остальных &mdash; 1
  <li><b>pixw</b> (<b>ш-пикс</b>) &mdash; ширина изображения (TIFF &mdash; для первой страницы) в пикселах
  <li><b>pixh</b> (<b>в-пикс</b>) &mdash; высота изображения (TIFF &mdash; для первой страницы) в пикселах
  <li><b>orient</b> (<b>ориентация</b>) &mdash; ориентация изображения: Квадрат, Альбом или Портрет
  <li><b>aspect</b> (<b>соотношение</b>) &mdash; отношение ширины изображения в пикселах к высоте (<b>pixw</b> / <b>pixh</b>)
  <li><b>pixd</b> (<b>д-пикс</b>) &mdash; диагональ в пикселах
  <li><b>pixels</b> (<b>пикселов</b>) &mdash; количество пикселов в изображении (<b>pixw</b> x <b>pixh</b>)
  <li><b>spp</b> (<b>каналов</b>) &mdash; количество сэмплов на пиксел (каналы в Photoshop)
  <li><b>bps</b> (<b>бит/к</b>) &mdash; количество бит на сэмпл (глубина цвета одного сэмпла/канала)
  <li><b>depth</b> (<b>глубина-цв</b>) &mdash; глубина цвета (количество бит на пиксел) = <b>spp</b> x <b>bps</b>
  <li><b>mode</b> (<b>режим</b>) &mdash; режим изображения: RGB, CMYK и т.д. В RGB-a суффикс <i>-a</i> означает альфа-канал
  <li><b>compr</b> (<b>сжатие</b>) &mdash; метод сжатия данных изображения: LZW, RLE и т.д.
  <li><b>xres</b> (<b>x-разр</b>) &mdash; разрешение картинки по оси X
  <li><b>yres</b> (<b>y-разр</b>) &mdash; разрешение картинки по оси Y<br>
    Для JPEG возможно извлечение разрешения из заголовков с маркерами APP0 (JFIF), APP1 (Exif) и APPd (Photoshop) &mdash; что раньше появится в файле.
    Файлы могут такую информацию не содержать (GIF &mdash; всегда).
    Если в файле данных о разрешении нет, можно использовать значения по умолчанию (см. <a href="#settings">настройки</a>)
  <li><b>docw</b> (<b>ш-док</b>) &mdash; ширина отпечатка (<b>pixw</b> / <b>xres</b>)
  <li><b>doch</b> (<b>в-док</b>) &mdash; высота отпечатка (<b>pixh</b> / <b>xres</b>)
  <li><b>docasp</b> (<b>соотн-док</b>) &mdash; отношение ширины отпечатка к высоте (<b>docw</b> / <b>doch</b>)
  <li><b>docd</b> (<b>д-док</b>) &mdash; диагональ отпечатка
  <li><b>square</b> (<b>площадь</b>) &mdash; площадь отпечатка (<b>docw</b> x <b>doch</b>)
  <li><b>fres</b> (<b>форс-разр</b>) &mdash; принудительное (форсированное) разрешение картинки по обоим осям
    (по усмотрению пользователя, на разрешение указанное в файле не влияет).
    Можно использовать для оценки размеров отпечатка при некотором произвольном разрешении.
    При изменении <b>fres</b> в диалоге изменения атрибутов файла реально изменяется настройка в INI-файле
    (<a href="#settings">forced_res</a>)
  <li><b>fdocw</b> (<b>ш-форс</b>) &mdash; тоже, что и <b>docw</b> для <b>fres</b>
  <li><b>fdoch</b> (<b>в-форс</b>) &mdash; тоже, что и <b>doch</b> для <b>fres</b>
  <li><b>fdocasp</b> (<b>соотн-форс</b>) &mdash; тоже, что и <b>docasp</b> для <b>fres</b>
  <li><b>fdocd</b> (<b>д-форс</b>) &mdash; тоже, что и <b>docd</b> для <b>fres</b>
  <li><b>fsquare</b> (<b>пл-форс</b>) &mdash; тоже, что и <b>square</b> для <b>fres</b>
  <li><b>ininame</b> (<b>ini-файл</b>) &mdash; имя файла настроек плагина. К изображению отношения не имеет
</ul>


<a name="#settings"></a>
<h2>Настройки</h2>

<p>При загрузке плагин считывает информацию из INI-файла для информационных плагинов
(обычно <code>contplug.ini</code> в каталоге TC), секция <code>[wdx4i]</code>, см. также поле <b>ininame</b>.
После установки он записывает туда значения по умолчанию:

<ul>
  <li><code>configured=1</code> &mdash; если не 0, плагин сконфигурирован
  <li><code>default_res=72.0</code> &mdash; если не 0, использовать такое разрешение для файлов (в единицах <code>default_res_units</code>), в которых информации о разрешении нет
  <li><code>default_res_units=0</code> &mdash; единицы измерения разрешения (1 &mdash; dpi, 2 &mdash; т/см) для файлов без информации о разрешении, 0 &mdash; не использовать разрешение по умолчанию
  <li><code>forced_res=300.0</code> &mdash; принудительное разрешение в единицах <code>forced_res_units</code>
  <li><code>forced_res_units=1</code> &mdash; единицы измерения принудительного разрешения (1 &mdash; dpi, 2 &mdash; т/см)
  <li><code>exif_resolution=1</code> &mdash; если не 0, извлекать информацию о разрешении JPEG из Exif (APP1)
  <li><code>pshop_resolution=1</code> &mdash; если не 0, извлекать информацию о разрешении JPEG из метаданных Photoshop (APPd)
  <li><code>size_decimals=0</code> &mdash; количество цифр в дробной части вещественных чисел (TC 6.52 и выше). 0 &mdash; на усмотрение TC
</ul>

<p><code>contplug.ini</code> можно изменить при помощи любого текстового редактора, например, Блокнота.


<h2>Дополнительно</h2>

<p>Расшифровка названий методов сжатия JPEG (в скобках русский перевод):

<ul>
  <li><samp>bDCT-H (бДКП-Х)</samp> &mdash; базовое дискретное косинусное преобразование (ДКП) плюс алгоритм Хаффмана
  <li><samp>xsDCT-H (рпДКП-Х)</samp> &mdash; расширенное последовательное ДКП, Хаффман
  <li><samp>pDCT-H (пДКП-Х)</samp> &mdash; прогрессивное ДКП, Хаффман
  <li><samp>sl-H (б/п-Х)</samp> &mdash; без потерь, Хаффман
  <li><samp>xsDCT-A (рпДКП-А)</samp> &mdash; расширенное последовательное ДКП, арифметическое кодирование
  <li><samp>pDCT-A (пДКП-А)</samp> &mdash; прогрессивное ДКП, арифметическое
  <li><samp>sl-A (б/п-А)</samp> &mdash; без потерь, арифметическое
</ul>

<p>Чтобы перевести плагин или исправить названия колонок по умолчанию добавьте
(исправьте) секцию для вашего языка в файле <samp>wdx4i.lng</samp>,
который находится в одном каталоге с плагином. Для примера см. секцию <samp>[RUS]</samp>.

<p>О некоторых единицах измерения:

<ul>
  <li><b>Квадрат (quadrat)</b> &mdash; единица имерения в типографской системе Дидо (на основе французского дюйма). Равен 48 пунктам или 18,05112 мм.
  <li><b>Пика, пайка (pica, pc)</b> = 1/6 английского дюйма = 4,2336 мм.
  <li><b>Поинт (point, pt)</b> = 1/72,27 английского дюйма = 0,3515 мм.
  <li><b>PostScript-поинт (ps-point)</b> = 1/72 английского дюйма = 0,3528 мм.
  <li><b>Твип, twip (tw)</b> [TWenty In Point ?] = 1/1440 английского дюйма = 0,01764 мм.
</ul>

<p>Плагин может установить разрешение только тех файлов, в которых оно уже
установлено (иначе потребовалось бы переписывать весь файл), и которые такую
информацию могут содержать. Например, GIF такую информацию вообще не может
содержать, а остальные форматы могут и содержать, и не содержать. Кроме того,
JPEG может не содержать маркера APP0, который понимает Photoshop (имеется в
виду 6-я версия), а разрешение записано только в метаданных <i>Exif</i>,
которые Photoshop игнорирует. Поэтому для таких JPEG после установки
разрешения плагин будет показывать новое, а Photoshop по-прежнему
использовать по умолчанию 72 dpi. Похожая ситуация имеет место и с PNG.

<a name="author"></a>

<p>Страничка плагина: <a href="http://wincmd.ru/plugring/wdx4i.html">http://wincmd.ru/plugring/wdx4i.html</a>

<p>&copy; Олег Бондарь aka Hobo (<code>hobo<!-- fuck spammers! -->-<!-- fuck spammers! -->mts <i>на</i> mail <i>тчк</i> ru</code>).
Заменить '<code>на</code>' на <em>собаку</em>, а '<code>тчк</code>' на '.' (<em>точка</em>).
В теме письма должно присутствовать слово '<samp>wdx4i</samp>'.

<hr>


<a name="history"></a>
<h2>История версий</h2>

<h3>0.5 (2013/10/24)</h3>

<ul>
  <li>Практически, то же самое, что и 0.5-beta, исправлены некоторые опечатки.
  <LI>В pluginst.inf добавлено значение 'version' (появилось в TC 8.50 beta 7).
</ul>

<h3>0.5-beta (2013/10/13)</h3>

<ul>
	<li>Добавлена поддержка <b>JPEG 2000</b>. Добавьте строку '<code>|FIND(&quot;jP  &quot;)</code>'
		('<b>jP</b>' с двумя пробелами) в строку <code>*_detect</code> в секции <code>[ContentPlugins]</code>
		вашего <code>wincmd.ini</code>. Или просто удалите и установите плагин вновь.
  <li>32-битная версия линкуется динамически с <code>msvcrt.dll</code>.
  <LI>Для PNG допускаются только известные чанки.
</ul>

<h3>0.4 (2012/03/23)</h3>

<ul>
  <li>Плагин линкуется с библиотекой времени исполнения статически и не зависит от
  <code>msvcrt.dll</code>.
	<li>Добавлена версия <code>x64</code>.
</ul>

<h3>0.3a (2009/02/06)</h3>

<ul>
  <li>Добавлено поле <b>orient</b>.
</ul>

<h3>0.3 (2009/02/04)</h3>

<ul>
  <li>Убрано поле <b>pages</b>.
  <li>Добавлены поля <b>images</b> и <b>layers</b>.
</ul>

<h3>0.2b (2009/02/02)</h3>

<ul>
  <li>Добавлено поле <b>depth</b>.
</ul>

<h3>0.2a (2007/10/07)</h3>

<ul>
  <li>Добавлено поле <b>badext</b>.
  <li>Мелкие исправления.
</ul>

<h3>0.2 (2007/10/02)</h3>

<ul>
  <li>Изменена строка определения типа файла. Вместо расширения теперь используется содержимое файла.
  <li>Добавлено поле с названием формата файла изображения.
  <li>Добавлена работа с JPEG-файлами, которые начинаются не с маркера SOI.
</ul>

<h3>0.1b (2007/10/01)</h3>

<ul>
  <li>Исправлена ошибка, вызывавшая крах при чтении некоторых файлов, сохранённых в Photoshop.
</ul>

<h3>0.1a (2007/09/07)</h3>

<ul>
  <li>Исправлена ошибка при вычислении диагонали и площади для единиц измерения
    отличных от мм.
</ul>

<h3>0.1 (2007/08/19)</h3>

<ul>
  <li>Исправлена ошибка при чтении заголовка BMP-файла. Спасибо Frank Zheng за багрепорт.
</ul>

<h3>0.1 beta4 (2007/07/02)</h3>

<ul>
  <li>Добавлены поля для принудительного разрешения.
  <li>Добавлено поле соотношения печатных размеров.
  <li>Добавлено поле с именем INI-файла.
</ul>

<h3>0.1 beta3 (2007/06/25)</h3>

<ul>
  <li>Добавлена функция <code>ContentSetValue()</code> для установки разрешения картинки в диалоге изменения атрибутов файла.
  <li>Исправлено определение разрешения PSD-файла.
  <li>Изменены названия некоторых единиц измерения.
</ul>

<h3>0.1 beta2 (2007/05/31)</h3>

<ul>
  <li>Добавлена возможность использования разрешения по умолчанию для файлов без такой информации.
  <li>Добавлено поле соотношения длин сторон.
  <li>Добавлены единицы измерения длин: <i>мм</i> (теперь по умолчанию), <i>метр</i>, <i>квадрат</i>, <i>пика</i>, <i>поинт</i>, <i>PostScript-поинт</i>, <i>твип (twip)</i>.
  <li>В <code>pluginst.inf</code> значение параметра <samp>defaultdir</samp> изменено на <samp>wdx4i</samp>.
</ul>

<h3>0.1 beta (2007/05/28)</h3>

<ul>
	<li>Первый выход в свет.
</ul>

</body>
</html>
